<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
<head>
    <meta charset="UTF-8">
    <title>Trade</title>
    <link rel="icon" type="image/png" th:href="@{/img/logo.png}">
    <link rel="stylesheet" th:href="@{/css/main.css}">
    <link rel="stylesheet" th:href="@{/css/trade/order.css}">
    <link rel="stylesheet" th:href="@{/css/trade/indicator.css}">
    <link rel="stylesheet" th:href="@{/css/trade/chart.css}">
    <link rel="stylesheet" th:href="@{/css/trade/balance.css}">
    <link rel="stylesheet" th:href="@{/css/trade/tradeTable.css}">
    <link rel="stylesheet" th:href="@{/css/trade/apiKeys.css}">
    <link rel="stylesheet" th:href="@{/css/trade/openOrders.css}">

</head>
<body>
<header class="topbar">
    <nav class="nav">
        <div class="nav-left">
            <a class="brand" th:href="@{/home}">PulseX</a>
            <a sec:authorize="isAuthenticated()" th:href="@{/trade}" class="active">Trade</a>
            <a sec:authorize="isAuthenticated()" th:href="@{/dashboard}" >Dashboard</a>
            <a sec:authorize="isAuthenticated()" th:href="@{/indicator}">Indicators</a>
            <a sec:authorize="hasRole('ADMIN')" th:href="@{/admin/dashboard}">Admin</a>
            <a sec:authorize="isAuthenticated()" th:href="@{/profile}">Profile</a>
        </div>

        <ul class="nav-right" sec:authorize="isAuthenticated()">
            <li class="user"><span sec:authentication="name">user</span></li>
            <li>
                <form th:action="@{/logout}" method="post" style="display:inline">
                    <input type="hidden" th:name="${_csrf.parameterName}" th:value="${_csrf.token}">
                    <button type="submit" class="linklike">Logout</button>
                </form>
            </li>
        </ul>
    </nav>
</header>
<main class="layout">
    <!-- LEFT COLUMN -->
    <section class="col-left">

        <div class="symbol-row"><label for="cryptoName"></label>
            <select id="cryptoName">
                <option value="ETH">ETH</option>
                <option value="BTC">BTC</option>
                <option value="LTC">LTC</option>
                <option value="Doge">DOGE</option>
            </select>
        </div>
        <section class="api-keys-bar">
            <div class="api-field">
                <label for="apiKey">Binance API key</label>
                <input id="apiKey" type="text" placeholder="Введите API key">
            </div>

            <div class="api-field">
                <label for="secretKey">Secret key</label>
                <input id="secretKey" type="password" placeholder="Введите Secret key">
            </div>

            <button id="saveApiKeysBtn" class="btn btn-small">
                Save
            </button>

            <span id="apiSaveMsg" class="api-save-msg" style="display:none;">
            Saved ✓
        </span>
        </section>

        <div class="order-boxs">

            <div class="box order-box" data-side="buy">
                <div class="box-header">
                    <div class="order-tabs">
                        <button class="order-tab active" data-type="limit">Limit</button>
                        <button class="order-tab" data-type="market">Market</button>
                    </div>
                </div>


                <div class="field">
                    <div class="field-label">Price</div>
                    <div class="field-box">
                        <input type="number" class="price-input" step="0.01" value="3049.91">
                        <span class="suffix">USDC</span>
                    </div>
                </div>


                <div class="field">
                    <div class="field-label">Amount</div>
                    <div class="field-box">
                        <input type="number" class="amount-input" step="0.0001" placeholder="0.0">
                        <span class="suffix base-symbol">ETH</span>
                    </div>
                </div>

                <!-- Total  -->
                <div class="field">
                    <div class="field-label">Total</div>
                    <div class="field-box">
                        <input type="number" class="total-input" step="0.01" placeholder="0.0">
                        <span class="suffix">USDC</span>
                    </div>
                </div>

                <div class="total-row">
                    <span>Est.</span>
                    <span class="est-text">≈ 0.00 USDC</span>
                </div>

                <div class="btn-row">
                    <button class="btn btn-buy action-btn">Buy ETH</button>
                </div>
            </div>


            <div class="box order-box" data-side="sell">
                <div class="box-header">
                    <div class="order-tabs">
                        <button class="order-tab active" data-type="limit">Limit</button>
                        <button class="order-tab" data-type="market">Market</button>
                    </div>
                </div>

                <!-- Price -->
                <div class="field">
                    <div class="field-label">Price</div>
                    <div class="field-box">
                        <input type="number" class="price-input" step="0.01" value="3049.91">
                        <span class="suffix">USDC</span>
                    </div>
                </div>

                <!-- Amount -->
                <div class="field">
                    <div class="field-label">Amount</div>
                    <div class="field-box">
                        <input type="number" class="amount-input" step="0.0001" placeholder="0.0">
                        <span class="suffix base-symbol">ETH</span>
                    </div>
                </div>

                <!-- Total -->
                <div class="field">
                    <div class="field-label">Total</div>
                    <div class="field-box">
                        <input type="number" class="total-input" step="0.01" placeholder="0.0">
                        <span class="suffix">USDC</span>
                    </div>
                </div>

                <div class="total-row">
                    <span>Est.</span>
                    <span class="est-text">≈ 0.00 USDC</span>
                </div>

                <div class="btn-row">
                    <button class="btn btn-sell action-btn">Sell ETH</button>
                </div>
            </div>

            <div class="box balances-box">
                <div class="balances-title">Available balances:</div>

                <div class="balances-list">
                    <div>Available balance: <span class="bal-fiat-available">0.00 USDC</span></div>
                    <div>Reserved balance: <span class="bal-fiat-reserved">0.00 USDC</span></div>
                    <div>Total balance: <span class="bal-fiat-total">0.00 USDC</span></div>

                    <div>Available crypto: <span class="bal-crypto-available">0.00000000 ETH</span></div>
                    <div>Reserved crypto: <span class="bal-crypto-reserved">0.00000000 ETH</span></div>
                    <div>Total crypto: <span class="bal-crypto-total">0.00000000 ETH</span></div>
                </div>

            </div>
        </div>
        <section class="orders-table-card">
            <div class="orders-title">Open Orders</div>

            <table class="orders-table">
                <thead>
                <tr>
                    <th>Time</th>
                    <th>Symbol</th>
                    <th>Side</th>
                    <th>Price</th>
                    <th>Amount</th>
                    <th>Status</th>
                    <th>Order ID</th>
                    <th>Action</th>
                </tr>
                </thead>
                <tbody id="ordersTableBody">
                </tbody>
            </table>
        </section>
        <!-- Trades -->
        <div class="box trades-card">
            <div class="trades-header">Trades</div>
            <table>
                <thead>
                    <tr>
                        <th>Time</th>
                        <th>Pair</th>
                        <th>Side</th>
                        <th>Price</th>
                        <th>Amount</th>
                        <th>Status</th>
                    </tr>
                </thead>
                <tbody></tbody>
            </table>
            <div class="trades-footer">
                <span class="link" id="trades-prev">&laquo; Prev</span>
                <span id="trades-page">1</span>
                <span class="link" id="trades-next">Next &raquo;</span>
            </div>
        </div>
    </section>

    <!-- RIGHT COLUMN -->
    <aside class="col-right">
        <div class="chart-card">
            <div class="chart-toolbar">
                <span id="chartSymbolLabel">Chart — ETH/USDT</span>

                <div class="chart-toolbar-right">
                    <div class="interval-tabs" id="intervalTabs">
                        <button data-interval="1m" class="active">1M</button>
                        <button data-interval="5m">5M</button>
                        <button data-interval="15m">15M</button>
                        <button data-interval="1h">1H</button>
                        <button data-interval="4h">4H</button>
                        <button data-interval="1d">1D</button>
                    </div>
                    <span id="chartExchangeLabel" class="exchange-label">
                1M • BINANCE
            </span>
                </div>
            </div>

            <div id="chartContainer" class="chart-placeholder"></div>
        </div>



        <!-- Indikatori kur klients var izvēleties. -->

        <div class="indicators-card">
            <div class="indicators-toolbar">
                <h3 class="indicators-title">Indicators</h3>

                <div class="indicators-dropdown">
                    <button type="button" id="indicatorsToggleBtn" class="indicators-manage-btn">
                        + Add
                    </button>

                    <div id="indicatorsDropdownPanel" class="indicators-dropdown-panel">
                        <div class="indicators-dropdown-title">
                            Показать индикаторы:
                        </div>
                        <div class="indicators-list">
                            <label>
                                <input type="checkbox" value="RSI" checked>
                                RSI(14)
                            </label>
                            <label>
                                <input type="checkbox" value="EMA">
                                EMA(14)
                            </label>
                            <label>
                                <input type="checkbox" value="SMA">
                                SMA(14)
                            </label>
                            <label>
                                <input type="checkbox" value="MACD">
                                MACD Hist
                            </label>
                        </div>
                    </div>
                </div>
            </div>

            <p style="font-size:11px;color:var(--muted);margin-top:0;">
                Здесь можно включать индикаторы, которые будут показываться ниже для выбранного символа.
            </p>

            <div id="selectedIndicators" class="indicators-selected">

            </div>
        </div>

    </aside>
</main>

<footer class="footer">
    <div>Community &nbsp;&nbsp; • &nbsp;&nbsp; About Us</div>
    <div class="footer-dots">
        <span class="active"></span><span></span><span></span>
    </div>
    <div>PulseX © 2025</div>
</footer>
<script src="https://unpkg.com/lightweight-charts@4.1.1/dist/lightweight-charts.standalone.production.js"></script>
<script src="/js/trade/chart.js"></script>
<script src="/js/trade/order.js"></script>
<script src="/js/trade/balance.js"></script>
<script src="/js/trade/indicator.js"></script>
<script src="/js/trade/table.js"></script>
<script src="/js/trade/apiKeys.js"></script>
<script src="/js/trade/openOrders.js"></script>
</body>
</html>